---
// Simplified Header for Aleto Auto Skla Servis
import { Icon } from "astro-icon/components";

const currentPath = Astro.url.pathname.split("/")[1];

const isActive = (href: string) => {
  if (currentPath === "" && href == "/") return true;
  if (currentPath !== "" && href.startsWith(`/${currentPath}`)) return true;
  return false;
};

const menu = [
  { label: "Domů", href: "/" },
  { label: "Služby", href: "/sluzby" },
  { label: "Kontakt", href: "/kontakt" },
];
---

<header class="surface-menu nav sticky top-0 z-50 shadow-md">
  <nav class="container-xl flex flex-nowrap items-center justify-between py-4">
    <!-- Logo/Brand -->
    <a
      href="/"
      aria-label="Aleto Auto Skla Servis"
      class="flex items-center gap-2 text-xl font-bold text-primary hover:text-accent"
    >
      <svg
        class="h-8 w-8"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <span class="hidden sm:inline">ALETO</span>
    </a>

    <!-- Desktop Navigation -->
    <ul class="hidden items-center gap-6 md:flex">
      {
        menu.map((link) => (
          <li>
            <a
              href={link.href}
              class={`font-medium uppercase tracking-wide transition-colors hover:text-accent ${
                isActive(link.href) ? "font-bold text-accent" : ""
              }`}
            >
              {link.label}
            </a>
          </li>
        ))
      }
    </ul>

    <!-- Phone Numbers (Desktop) -->
    <div class="hidden items-center gap-4 lg:flex">
      <a
        href="tel:+420731409899"
        class="flex items-center gap-2 rounded-full bg-primary px-4 py-2 text-sm font-semibold text-white transition-transform hover:scale-105"
      >
        <svg
          class="h-4 w-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
          ></path>
        </svg>
        731 409 899
      </a>
      <a
        href="tel:+420608102471"
        class="flex items-center gap-2 rounded-full bg-warning px-4 py-2 text-sm font-semibold text-dark transition-transform hover:scale-105"
      >
        <svg
          class="h-4 w-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
          ></path>
        </svg>
        608 102 471
      </a>
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-button"
      class="rounded-md p-2 hover:bg-primary/10 md:hidden"
      aria-label="Menu"
    >
      <svg
        class="h-6 w-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
    </button>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden border-t border-primary/20 md:hidden">
    <div class="container-xl py-4">
      <ul class="space-y-3">
        {
          menu.map((link) => (
            <li>
              <a
                href={link.href}
                class={`block rounded-md px-4 py-2 font-medium uppercase transition-colors hover:bg-primary/10 ${
                  isActive(link.href)
                    ? "bg-primary/20 font-bold text-accent"
                    : ""
                }`}
              >
                {link.label}
              </a>
            </li>
          ))
        }
      </ul>
      <div class="mt-4 space-y-2">
        <a
          href="tel:+420731409899"
          class="flex items-center justify-center gap-2 rounded-full bg-primary px-4 py-3 font-semibold text-white"
        >
          <svg
            class="h-5 w-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
            ></path>
          </svg>
          731 409 899
        </a>
        <a
          href="tel:+420608102471"
          class="flex items-center justify-center gap-2 rounded-full bg-warning px-4 py-3 font-semibold text-dark"
        >
          <svg
            class="h-5 w-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
            ></path>
          </svg>
          608 102 471
        </a>
      </div>
    </div>
  </div>
</header>

<script>
  function initMobileMenu() {
    // Mobile menu toggle - client-side only
    const menuButton = document.getElementById("mobile-menu-button");
    const mobileMenu = document.getElementById("mobile-menu");

    if (menuButton && mobileMenu) {
      const header = document.querySelector("header");

      menuButton.addEventListener("click", () => {
        const isHidden = mobileMenu.classList.toggle("hidden");
        console.log("isHidden :>> ", isHidden);
        if (header) {
          header.setAttribute("data-menu-open", (!isHidden).toString());
        }
      });

      // Close mobile menu when clicking a link
      const mobileLinks = mobileMenu.querySelectorAll("a");
      mobileLinks.forEach((link) => {
        link.addEventListener("click", () => {
          mobileMenu.classList.add("hidden");
          if (header) {
            header.setAttribute("data-menu-open", "false");
          }
        });
      });
    }
  }

  // Support View Transitions
  document.addEventListener("astro:page-load", initMobileMenu);
</script>

<style>
  .nav {
    transition: transform 0.5s;
  }
</style>
